<!DOCTYPE html><html> <head><meta charset=utf-8><title>passgen</title></head> <body> <label for=seedInput>Seed</label> <input id=seedInput type=password><br> <label for=roundsInput>Rounds</label> <input id=roundsInput type=number><br> <button id=copyPasswordButton>Copy Password</button> <button id=showPasswordButton>Show Password</button><br> <label for=userNamesInput>User List (space-seperated)</label><br> <textarea cols=32 id=userNamesInput rows=8></textarea><br> <div style="width: 200px; height: 24px; background-color: gray;"> <div id=progressBar style="position: absolute; height:24px; width:0px; background-color: lime;"></div> <div id=progressCounter style="position: absolute"></div> </div> <label for=userListItemDelimiterInput>Item Delimiter</label> <input id=userListItemDelimiterInput placeholder=, value=,><br> <label for=userListRecordDelimiterInput>Record Delimiter</label> <input id=userListRecordDelimiterInput placeholder=%0A value=%0A><br> <button id=copyUserListPasswordButton>Copy User List Passwords</button> <button id=showUserListPasswordButton>Show User List Passwords</button><br> <label for=userListFileName>File Name</label> <input id=userListFileName placeholder="User File Name" type=text value=users.csv> <button id=downloadUserListPasswordButton>Download User List</button> <a id=downloadLink style=display:none;></a><br> <button id=clipboardClearButton>Clear Clipboard</button> <script>window.sha256=function sha256(d){function g(p,q){return p>>>q|p<<32-q}for(var c=Math.pow,m=c(2,32),a,r="",f=[],h=8*d.length,b=sha256.h=sha256.h||[],n=sha256.k=sha256.k||[],k=n.length,l={},e=2;64>k;e++)if(!l[e]){for(a=0;313>a;a+=e)l[a]=e;b[k]=c(e,.5)*m|0;n[k++]=c(e,1/3)*m|0}for(d+="\u0080";d.length%64-56;)d+="\x00";for(a=0;a<d.length;a++){c=d.charCodeAt(a);if(c>>8)return;f[a>>2]|=c<<(3-a)%4*8}f[f.length]=h/m|0;f[f.length]=h;for(c=0;c<f.length;){d=f.slice(c,c+=16);m=b;b=b.slice(0,8);for(a=0;64>a;a++)k=
d[a-15],l=d[a-2],h=b[0],e=b[4],k=b[7]+(g(e,6)^g(e,11)^g(e,25))+(e&b[5]^~e&b[6])+n[a]+(d[a]=16>a?d[a]:d[a-16]+(g(k,7)^g(k,18)^k>>>3)+d[a-7]+(g(l,17)^g(l,19)^l>>>10)|0),h=(g(h,2)^g(h,13)^g(h,22))+(h&b[1]^h&b[2]^b[1]&b[2]),b=[k+h|0].concat(b),b[4]=b[4]+k|0;for(a=0;8>a;a++)b[a]=b[a]+m[a]|0}for(a=0;8>a;a++)for(c=3;c+1;c--)f=b[a]>>8*c&255,r+=(16>f?0:"")+f.toString(16);return r};
</script> <script>function hex2bigint(b){ret=0n;for(let a=0;a<b.length;a+=2)ret=ret<<8n|BigInt(parseInt(b.slice(a,a+2),16));return ret}function trun64(b){return b&18446744073709551615n}function rol64(b,a){b=BigInt(b);a=BigInt(a);return trun64(b<<a)|trun64(b>>64n-a)}function bigIntToU64Array(b){const a=[];for(;0n!=b;)a.push(b&18446744073709551615n),b>>=64n;return a}function u64ArrayToBigInt(b){let a=0n;for(let d=b.length-1;0<=d;d--)a<<=64n,a+=trun64(BigInt(b[d]));return a}
function randBigInt(){let b=0n;for(let a=0;16>a;a++)b<<=16n,b+=BigInt(Math.floor(65536*Math.random()));return b}const progressBar=document.getElementById("progressBar"),progressCounter=document.getElementById("progressCounter");function setProgressBar(b,a){progressCounter.textContent=`${b} / ${a}`;progressBar.style.width=`${b/a*200}px`}consonants="b k d f g h j l m n p r s t v w y z bl cl fl gl pl br cr dr fr gr pr tr sk sl sp st sw spr str ch sh th th wh ng nk".split(" ");vowels="a e i o u oo oi ow ey oo aw".split(" ");
symbols="!@#$%^&*?_-+=".split("");
class XorshiftGenerator{constructor(b,a=256){this.state=BigInt(b);this.size=BigInt(a)}advance(b=1){let a=bigIntToU64Array(this.state),d;for(let e=0;e<b;e++){d=trun64(9n*rol64(5n*a[1],7n));const g=a[1]<<17n;a[2]^=a[0];a[3]^=a[1];a[1]^=a[2];a[0]^=a[3];a[2]^=g;a[3]=rol64(a[3],45n)}this.state=u64ArrayToBigInt(a);return d}advance256(b=1){b=this.advance(b);return b>>(b>>58n)%56n&255n}choice(b){return b[this.advance256()%BigInt(b.length)]}join(b,a){let d=[];b.forEach(e=>{d.push(e);d.push(this.choice(a))});
return d.slice(0,d.length-1).join("")}genWord(b=5){let a=[];for(let d=0;d<b;d++)a.push(this.choice(d%2?vowels:consonants));return a.join("")}genPassword(b=2,a=1){let d=[];for(var e=0;e<b;e++)d.push(this.genWord());for(b=0;b<a;b++){e=[];for(let g=0;4>g;g++)e.push(this.advance256()%10n);d.push(e.join(""))}return this.join(d,symbols)}}
(async()=>{async function b(){if(0==g.value.length)throw alert("No seed present"),Error("No seed present");const c=new XorshiftGenerator(hex2bigint(await sha256(g.value)));c.advance(parseInt(q.value));return c.genPassword()}async function a(c){if(symbols.includes(c.target.value)||consonants.includes(c.target.value)||vowels.includes(c.target.value))return alert("Invalid Delimiter: "+c.target.value),c.target.value="",!1}function d(){if(0==g.value.length)throw alert("No seed present"),Error("No seed present");
const c=u.value.split("\n").filter(f=>0<f.length),k=[];return new Promise((f,l)=>{let h=0;const t=function(){const r=new XorshiftGenerator(hex2bigint(sha256(g.value+c[h])));r.advance(parseInt(q.value));k.push([c[h],r.genPassword()]);setProgressBar(parseInt(h)+1,c.length);h++;h<c.length?setTimeout(t,10):setTimeout(()=>f(k),10)};setTimeout(t,10)})}async function e(c,k,f){c.forEach(l=>{let h=!0;l[0].includes(k)&&(h&=confirm(`Record '${l[0]}' contains '${k}'. Continue?`));l[0].includes(f)&&(h&=confirm(`Record '${l[0]}' contains '${f}'. Continue?`));
if(!h)throw Error("Record contained delimiter");});return c.map(l=>l.join(k)).join(f)}const g=document.getElementById("seedInput"),q=document.getElementById("roundsInput"),v=document.getElementById("copyPasswordButton"),w=document.getElementById("showPasswordButton"),u=document.getElementById("userNamesInput"),x=document.getElementById("copyUserListPasswordButton"),y=document.getElementById("showUserListPasswordButton"),m=document.getElementById("userListItemDelimiterInput"),n=document.getElementById("userListRecordDelimiterInput"),
z=document.getElementById("downloadUserListPasswordButton"),p=document.getElementById("downloadLink"),A=document.getElementById("userListFileName"),B=document.getElementById("clipboardClearButton");v.addEventListener("click",async c=>{navigator.clipboard.writeText(await b())});w.addEventListener("click",async c=>{alert(await b())});m.addEventListener("change",a);n.addEventListener("change",a);x.addEventListener("click",async c=>{navigator.clipboard.writeText(await e(await d(),decodeURIComponent(m.value||
","),decodeURIComponent(n.value||"%0A")))});y.addEventListener("click",async c=>{alert(await e(await d(),decodeURIComponent(m.value||","),decodeURIComponent(n.value||"%0A")))});z.addEventListener("click",async c=>{p.download=A.value;p.href="data:text/plain,"+encodeURIComponent(await e(await d(),",","\n"));p.click()});B.addEventListener("click",async c=>{const k=new XorshiftGenerator(randBigInt());c=Math.floor(128*Math.random());for(let f=0;f<c;f++)setTimeout(()=>navigator.clipboard.writeText(k.genPassword()),
1E3*Math.random());setTimeout(()=>alert("Clipboard Cleared"),1E3)})})();
</script> </body> </html>